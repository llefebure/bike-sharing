})
plot(arr)
abline(h=10)
A <- matrix(c(1,2,3,4), nrow = 2)
A
A %*% A
n <- A
for(i in 1:100){
n <- n %*% A
}
n
x = runif(100)
y = runif(100)
abs(sqrt(x) - sqrt(y)) < abs(x - y)
abs(sqrt(x) - sqrt(y)) <= abs(x - y)
x[33]
y[33]
sqrt(x[33]) - sqrt(y[33])
x - y
sqrt(x[33]) - sqrt(y[33])
x[33] - y[33]
plot(x, sqrt(x))
abs(sqrt(x) - sqrt(y))
abs(sqrt(x) - sqrt(y)) < abs(x-y)
x[65]
y[65]
abs(sqrt(x[65]) - sqrt(y[65]))
abs(x - y)
abs(sqrt(x[65]) - sqrt(y[65]))
abs(x[65] - y[65])
x
abs(x**1.1 - y**1.1 < abs(x-y)
abs(x**1.1 - y**1.1 < abs(x-y))
abs(x**1.1 - y**1.1) < abs(x-y)
library(gbm)
?gbm
?gbm
?filled.contour
example(filled.contour)
volcano
head(volcano)
Sigma <- matrix(c(1,0,0,0), nrow = 2)
Sigma
Sigma <- matrix(c(1,0,0,0), nrow = 2)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
f(1,1)
f(1,2)
f(1,10)
f(1,1000)
f(x=1,y=1000)
combn(x, y)
?combn
z <- matrix(0, nrow = length(x))
z
head(z)
Sigma <- matrix(c(1,0,0,0), nrow = 2)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = 0, to = 2, by = .01)
y <- seq(from = 0, to = 2, by = .01)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,0,0,0), nrow = 2)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = 0, to = 5, by = .01)
y <- seq(from = 0, to = 5, by = .01)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
x <- seq(from = 0, to = 5, by = .01)
y <- seq(from = 0, to = 5, by = .01)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .01)
y <- seq(from = -1, to = 1, by = .01)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,0,4,0), nrow = 2)
Sigma
Sigma <- matrix(c(1,4,0,0), nrow = 2)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .01)
y <- seq(from = -1, to = 1, by = .01)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,4,0,0), nrow = 2)
Sigma
Sigma <- matrix(c(1,0,4,0), nrow = 2)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .01)
y <- seq(from = -1, to = 1, by = .01)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,0,4,0), nrow = 2)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,4,0,0), nrow = 2)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,4,0,0), nrow = 2)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,4,0,0), nrow = 2)
Sigma
Sigma <- matrix(c(1,4,0,1), nrow = 2)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,4,2,1), nrow = 2)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,0,0,1), nrow = 2, byrow = T)
Sigma
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[i])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,0,0,1), nrow = 2, byrow = T)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[j])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,4,0,0), nrow = 2, byrow = T)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[j])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,0,4,0), nrow = 2, byrow = T)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[j])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,0,
0,0),
nrow = 2, byrow = F)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[j])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,1,
1,0),
nrow = 2, byrow = F)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[j])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(2,4,
4,8),
nrow = 2, byrow = F)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[j])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,0,
0,0),
nrow = 2, byrow = F)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[j])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,0,
2,0),
nrow = 2, byrow = F)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[j])
}
}
filled.contour(x, y, z)
Sigma <- matrix(c(1,2,
2,4),
nrow = 2, byrow = F)
f <- function(x, y){
exp(-.5*(Sigma[1,1]*x**2 + (Sigma[1,2] + Sigma[2,1])*x*y + Sigma[2,2]*y**2))
}
x <- seq(from = -1, to = 1, by = .1)
y <- seq(from = -1, to = 1, by = .1)
z <- matrix(0, nrow = length(y), ncol = length(x))
for (i in 1:nrow(z)){
for (j in 1:ncol(z)){
z[i,j] <- f(x[i], y[j])
}
}
filled.contour(x, y, z)
a <- mean(c(1,2,3))
train <- getTrainingSet()
setwd("~/Documents/Projects/BikeShare/Rmd")
library(dplyr)
library(readr)
library(stringr)
library(ggplot2)
library(scales)
library(h2o)
source("../R/helpers.R")
train <- getTrainingSet()
train$weekday = factor(train$weekday)
train$hour = factor(train$hour)
fit <- glm(arrivals~weekday+hour, data = filter(train, station_id == 69), family = "poisson")
fit
predict(fit, newdata = data.frame(weekday = "Weekday", hour = "17"))
filter(train, station_id == 69, hour = "17", weekday = "Weekday") %>% select(arrivals)
t=filter(train, station_id == 69, hour == "17", weekday == "Weekday") %>% select(arrivals)
t
hist(t)
hist(t$arrivals)
hist(rpoisson(20, 100))
?rpois
hist(rpois(100, 20))
mean(t$arrivals)
hist(rpois(10000, 18.7))
hist(rpois(100000000, 18.7))
length(t$arrivals)
hist(rpois(391, 18.7))
fit
predict(fit)
?predict
predict(fit, type = "response")
predict(fit, newdata = data.frame(weekday = "Weekday", hour = "17"), type = "response")
format(0:23, "%H")
format(0:23, "%d")
0:23
str(0:23)
str_pad(0, )
?str_pad
str_pad(0, 2, side = "left")
str_pad(0, 2, side = "left", pad = "0")
str_pad(0:23, 2, side = "left", pad = "0")
s=str_pad(0:23, 2, side = "left", pad = "0")
predict(fit, newdata = data.frame(weekday = "Weekday", hour = s), type = "response")
f = predict(fit, newdata = data.frame(weekday = "Weekday", hour = s), type = "response")
plot(f)
plot(f, type = "l")
f
plot(f, type = "b")
fit <- glm(arrivals~weekday+hour, data = filter(train, station_id == 2), family = "poisson")
f = predict(fit, newdata = data.frame(weekday = "Weekday", hour = s), type = "response")
plot(f, type = "l")
file_paths
file_paths <- getFilePaths()
w <- read_csv(file_paths$weather[1])
w
w$zip
w
w %>% arrange(Date)
unique(w$zip)
train
w
w %>% arrange(Date)
fit <- glm(arrivals~weekday+hour+factor(month), data = filter(train, station_id == 2), family = "poisson")
f = predict(fit, newdata = data.frame(weekday = "Weekday", hour = s, month = "08"), type = "response")
plot(f)
plot(f, type = "l")
hist(train$arrivals)
headt(train)
head(train)
kable(head(train))
library(knitr)
kable(head(train))
trip_d
trip_da
trip_data <- rbind(read_csv(file_paths$trip[2]),
read_csv(file_paths$trip[3]))
trip_data
nrow(trip_data)
train
train
train
train
full <- train
full
train <- full %>% filter(year == "2014" | (year == "2015" & month < "04"))
train
test <- full %>% filter(year == "2015" & month >= "04")
fit <- glm(arrivals ~ factor(month) + factor(weekday) + factor(hour), family = "poisson")
fit <- glm(arrivals ~ factor(month) + factor(weekday) + factor(hour), data = train, family = "poisson")
fit
predict(fit)
predict(fit, type = "response")
a=predict(fit, type = "response")
a
train$arrivals
mean(abs(train$arrivals - a)**2)
preds <- predict(fit, newdata = test, type = "response")
preds
mean(abs(train$arrivals - a)**2)
mean(abs(test$arrivals - preds)**2)
sqrt(mean(abs(test$arrivals - preds)**2))
preds
hist(preds)
hist(preds)
max(preds)
fit <- glm(arrivals ~ factor(weekday) + factor(hour), data = train, family = "poisson")
preds <- predict(fit, newdata = test, type = "response")
mean(abs(test$arrivals - preds)**2)
max(preds)
train
train.st <- filter(train, station_id == 69)
test.st <- filter(test, station_id == 69)
train.st <- filter(train, station_id == 69)
test.st <- filter(test, station_id == 69)
fit <- glm(arrivals ~ factor(weekday) + factor(hour), data = train.st, family = "poisson")
preds <- predict(fit, newdata = test.st, type = "response")
preds
max(preds)
mean(abs(test.st$arrivals - preds)**2)
plot(test.st$arrivals, preds)
fit <- glm(arrivals ~ factor(weekday) + factor(hour), data = train.st)
preds <- predict(fit, newdata = test.st, type = "response")
mean(abs(test.st$arrivals - preds)**2)
max(preds)
fit <- glm(arrivals ~ factor(weekday) + factor(hour), data = train.st, family = "poisson")
preds <- predict(fit, newdata = test.st, type = "response")
max(preds)
which(preds > 14)
test.st$arrivals[which(preds > 14)]
hist(test.st$arrivals[which(preds > 14)])
test.st
fit
fit <- glm(arrivals ~ factor(weekday) + factor(hour) + factor(hour):factor(weekday), data = train.st, family = "poisson")
preds <- predict(fit, newdata = test.st, type = "response")
mean(abs(test.st$arrivals - preds)**2)
fit
preds
max(preds)
library(randomForest)
?randomForest
rf <- randomForest(arrivals ~ factor(weekday) + factor(hour), data = train.st)
rf <- randomForest(arrivals ~ factor(weekday) + factor(hour), data = train.st)
train.st
rf <- randomForest(arrivals ~ weekday + hour, data = train.st)
preds<-predict(rf, newdata = train.st)
mean(abs(test.st$arrivals - preds)**2)
lenght(preds)
length(preds)
nrow(test.st)
preds<-predict(rf, new = train.st)
length(preds)
?predict
?predict.rf
rf
?randomForest
preds<-predict(rf, newdata = test.st, type = "response")
mean(abs(test.st$arrivals - preds)**2)
train.st <- filter(train, station_id == 4)
test.st <- filter(test, station_id == 4)
fit <- glm(arrivals ~ factor(weekday) + factor(hour) + factor(hour):factor(weekday), data = train.st, family = "poisson")
preds <- predict(fit, newdata = test.st, type = "response")
mean(abs(test.st - preds)**2)
preds
mean(abs(test.st$arrivals - preds)**2)
max(preds)
plot(test.st$arrivals, preds)
